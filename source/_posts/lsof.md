---
title: lsof
date: 2019-04-20 12:14:43
tags:
- 常用工具
---

lsof(list open file)是一个列出当前系统打开的文件描述符的工具。通过它可以了解感兴趣的进程打开了哪些文件描述符，或者感兴趣的文件描述符被哪些进程打开。

常用选项：

- -i，显示scoket文件描述符

使用方法： 

```
lsof -i [46] [protocol] [@hostname|ipaddr][:service|port]
```

其中4表示IPv4协议，6表示IPv6协议，protocol指定传输层协议，可以是TCP或者UDP，hostname指定主机名，ipaddr指定主机的IP地址，service指定服务名，port指定端口号。|代表两个填一个就行

<!--more-->

例如，要显示所有连接到主机192.168.1.108的ssh服务的socket文件描述符

```
losf -i@192.168.1.108:22
```

- -u，显示指定用户启动的所有进程打开的所有文件描述符
- -c，显示指定的命令打开的所有文件描述符，

比如要查看websrv程序打开了哪些文件描述符，可以使用如下命令:

lsof -c websrc

- -p，显示指定的进程打开的所有文件描述符
- -t，仅显示打开了目标文件描述符的进程的pid

还可以直接将文件名作为lsof命令的参数，以查看哪些进程打开了该文件。

lsof命令的输出内容：

![](/pic/lsof输出内容.png)

